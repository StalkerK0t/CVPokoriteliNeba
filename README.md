# Отчёт команды "Покорители неба" о ходе разработки неросети для распознавания армянского алфавита
## 1. Введение
С точки зрения компьютерного зрения задача, поставленная организаторами является задачей локализацией изображений букв на видеопотоке и их последующая классификация. Мы решили начать с задачи классификации - обучить нейросеть классифицировать буквы армянского алфавита. Для решения данной задачи мы подготовили свой датасет.
## 2. Сбор датасета
Из расчета, что самолет летит на высоте примерно 30-50 метров и размеры полотен с буквами - 3х3 метра, был взят масштаб 1:30 - для удобства сборки датасета и сохранения угловых размеров полотна и количества пикселей на букву  относительно камеры: размер полотна с буквой - 10х10 см, высота от камеры до поверхности съемки около метра. 

Камера __Raspberry Pi Camera Module 2__ зафиксированная на штативе производила фото букв, ориентированных случайным образом и  расположенных на контрастном фоне, из расчета 200 снимков на каждую букву - итого 7200 снимков в сумме.

<table>
  <tr>
    <td><image
  src="images/image.png" width="200"
  alt="Текст с описанием картинки"
  caption="Подпись под картинкой"></td>
    <td><image width="200"
  src="images/image-1.png"
  alt="Текст с описанием картинки"
  caption="Подпись под картинкой"></td>
  </tr>
    <tr>
    <td>Процесс сборки датасета</td>
    <td>Полученное изображение</td>
  </tr>
</table>

## 2. Предобработка изображений
После сборки датасета изображения подверглись предобработке: фон был убран, а полотно с буквами с помощью аффинного преобразования форма полотна с буквой была приведена к квадрату и сжато до размеров 32x32 пиксаля и бинаризованно. Для выполнения обработки изображений был написан код `data_preprocessing.py`

![alt text](images/image-2.png)
Пример исходного и биноризованного изображения

<image width="200"
  src="images/image-3.png"
  alt="Текст с описанием картинки"
  caption="Подпись под картинкой">

Пример полностью обработанного изображения

## 3. Обучение нейросети
Для обучения нейросети была выбрана библиотека `PyTorch`. С использованием её инструментов была спроектирована сверточная нейронная сеть следующей конфигурации:




|Layer (type:depth-idx)| Output Shape   |Param #    |
| ------------      | ------------      | ----------|
| PNebaNet          | [1, 36]           | --        |
| ├─Conv2d: 1-1     | [1, 64, 28, 28]   |  1,664    |
| ├─MaxPool2d: 1-2  | [1, 64, 14, 14]   | --        |
| ├─Conv2d: 1-3     | [1, 128, 12, 12]  | 73,856    |
| ├─MaxPool2d: 1-4  | [1, 128, 6, 6]    |  --       |
| ├─Linear: 1-5     | [1, 128]          | 589,952   |
| ├─Linear: 1-6     | [1, 64]           | 8,256     |
| ├─Linear: 1-7     | [1, 36]           | 2,340     |

Total trainable params: 676,068 
