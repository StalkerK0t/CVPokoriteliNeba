# Отчёт команды "Покорители неба" о ходе разработки неросети для распознавания армянского алфавита
## 1. Введение
С точки зрения компьютерного зрения задача, поставленная организаторами является задачей локализацией изображений букв на видеопотоке и их последующая классификация. Мы решили начать с задачи классификации - обучить нейросеть классифицировать буквы армянского алфавита. Для решения данной задачи мы подготовили свой датасет.
## 2. Сбор датасета
Из расчета, что самолет летит на высоте примерно 30-50 метров и размеры полотен с буквами - 3х3 метра, был взят масштаб 1:30 - для удобства сборки датасета и сохранения угловых размеров полотна и количества пикселей на букву  относительно камеры: размер полотна с буквой - 10х10 см, высота от камеры до поверхности съемки около метра. 

Камера __Raspberry Pi Camera Module 2__ зафиксированная на штативе производила фото букв, ориентированных случайным образом и  расположенных на контрастном фоне, из расчета 200 снимков на каждую букву - итого 7200 снимков в сумме. 

<table>
  <tr>
    <td><image
  src="images/image.png" width="200"
  alt="Текст с описанием картинки"
  caption="Подпись под картинкой"></td>
    <td><image width="200"
  src="images/image-1.png"
  alt="Текст с описанием картинки"
  caption="Подпись под картинкой"></td>
  </tr>
    <tr>
    <td>Процесс сборки датасета</td>
    <td>Полученное изображение</td>
  </tr>
</table>

## 2. Предобработка изображений
После сборки датасета изображения подверглись предобработке: фон был убран, а полотно с буквами с помощью аффинного преобразования форма полотна с буквой была приведена к квадрату и сжато до размеров 32x32 пиксаля и бинаризованно. Для выполнения обработки изображений был написан код `data_preprocessing.py` 
После обработки датасет был увеличен аугментированными изображениями (смещение, масштабирование, небольшой поворот) до 30000 изображений. 

![alt text](images/image-2.png)
Пример исходного и биноризованного изображения

<image width="200"
  src="images/image-3.png"
  alt="Текст с описанием картинки"
  caption="Подпись под картинкой">

Пример полностью обработанного изображения

## 3. Обучение нейросети
Для обучения нейросети была выбрана библиотека `PyTorch`. С использованием её инструментов была спроектирована сверточная нейронная сеть следующей конфигурации:




|Layer (type:depth-idx)| Output Shape   |Param #    |
| ------------      | ------------      | ----------|
| PNebaNet          | [1, 36]           | --        |
| ├─Conv2d: 1-1     | [1, 64, 28, 28]   |  1,664    |
| ├─MaxPool2d: 1-2  | [1, 64, 14, 14]   | --        |
| ├─Conv2d: 1-3     | [1, 128, 12, 12]  | 73,856    |
| ├─MaxPool2d: 1-4  | [1, 128, 6, 6]    |  --       |
| ├─Linear: 1-5     | [1, 128]          | 589,952   |
| ├─Linear: 1-6     | [1, 64]           | 8,256     |
| ├─Linear: 1-7     | [1, 36]           | 2,340     |

Total trainable params: 676,068 

# 4. Тестирование обученной нейросети

На обучение было отведено 5 эпох. Результаты для каждой буквы в алфавитном порядке получились следующие:
- Accuracy of     0 : 97.849462 % 
- Accuracy of     1 : 98.876404 % 
- Accuracy of     2 : 98.823529 % 
- Accuracy of     3 : 100.000000 % 
- Accuracy of     4 : 97.872340 % 
- Accuracy of     5 : 93.333333 % 
- Accuracy of     6 : 99.115044 % 
- Accuracy of     7 : 91.743119 % 
- Accuracy of     8 : 84.313725 % 
- Accuracy of     9 : 85.555556 % 
- Accuracy of    10 : 86.250000 % 
- Accuracy of    11 : 96.428571 % 
- Accuracy of    12 : 95.575221 % 
- Accuracy of    13 : 86.666667 % 
- Accuracy of    14 : 90.384615 % 
- Accuracy of    15 : 95.555556 % 
- Accuracy of    16 : 88.392857 % 
- Accuracy of    17 : 88.659794 % 
- Accuracy of    18 : 99.000000 % 
- Accuracy of    19 : 82.954545 % 
- Accuracy of    20 : 97.142857 % 
- Accuracy of    21 : 90.425532 % 
- Accuracy of    22 : 90.322581 % 
- Accuracy of    23 : 71.849057 % 
- Accuracy of    24 : 87.155963 % 
- Accuracy of    25 : 85.714286 % 
- Accuracy of    26 : 94.318182 % 
- Accuracy of    27 : 94.782609 % 
- Accuracy of    28 : 75.651376 % 
- Accuracy of    29 : 90.816327 % 
- Accuracy of    30 : 95.049505 % 
- Accuracy of    31 : 100.000000 % 
- Accuracy of    32 : 100.000000 % 
- Accuracy of    33 : 98.198198 % 
- Accuracy of    34 : 97.826087 % 
- Accuracy of    35 : 96.875000 %

В общем случае точность распознавания составила более 85% процентов, за исключением букв 23 и 28, которые при повороте на 180° превращаются друг в друга.

<table>
  <tr>
    <td><image
  src="images/image-5.png" height="250"
  alt="Текст с описанием картинки"
  caption="Подпись под картинкой"></td>
    <td><image height="250"
  src="images/image-4.png"
  alt="Текст с описанием картинки"
  caption="Подпись под картинкой"></td>
  </tr>
    <tr>
    <td>Буква 23</td>
    <td>Буква 28</td>
  </tr>
</table>